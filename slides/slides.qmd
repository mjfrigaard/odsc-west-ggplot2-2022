---
title: "Data Visualization with `ggplot2`"
subtitle: "ODSC West"
logo: "../img/ODSC_Logo_2020.png"
format: 
  revealjs: 
    height: 900
    width: 1600
    theme: [dark, slides.scss]
    highlight-style: dracula
    transition: fade
    slide-number: true
    chalkboard: true
    scrollable: true
from: markdown+emoji
editor: source
---

```{r setup, include=FALSE, message=FALSE, warning=FALSE, eval=TRUE}
library(ggplot2)
library(dplyr)
library(tidyr)
library(faux)
library(palmerpenguins)
penguins <- palmerpenguins::penguins
# the following creates a sample that has 100 observations of 2
# variables, drawn from a population where 
# - X has a mean of 0 and SD of 1 
# - Y has a mean of 20 and SD of 5
# - X correlates with Y with r = 0.75
cor90df <- rnorm_multi(n = 300, 
                  mu = c(0, 20),
                  sd = c(1, 5),
                  r = c(0.90), 
                  varnames = c("X", "Y"),
                  empirical = FALSE)
cor20df <- rnorm_multi(n = 300, 
                  mu = c(0, 20),
                  sd = c(1, 5),
                  r = c(0.20), 
                  varnames = c("X", "Y"),
                  empirical = FALSE)
```

# Outline

::: columns
::: {.column width="45%"}
::: incremental
**Part 1**

-   *Why do we need graphs?*

-   *An exploratory mindset*

-   *Surprise or confirm, then communicate*

-   *The grammar of graphics*
:::
:::

::: {.column width="5%"}
:::

::: {.column width="50%"}
::: incremental
-   **Part 2**
-   *RStudio Cloud*\
-   *Exercises & solutions*\
-   *Creating a graph (layer-by-layer)*\
-   *Applying the grammar*
:::
:::
:::

# Part 1 {background-color="#1dfd07"}

::: columns
::: {.column width="25%"}
:::

::: {.column width="75%"}
::: incremental
-   Intros :wave:
-   Workshop materials :arrow_down:
-   Basic understand of `ggplot2` syntax :heavy_check_mark:
-   Build your first graph! :heavy_check_mark:
:::
:::
:::

# Why do we need graphs? {.smaller}

## Raw data don't communicate well {.smaller}

. . .

<br>

::: {style="font-size: 1.25em;"}
It's hard to make sense of millions of rows and/or thousands of columns
:::

. . .

<br>

::: {style="font-size: 1.25em;"}
Fortunately, we are **excellent at seeing patterns**:
:::

. . .

<br>

::: {style="font-size: 1.10em; color: #ffac00;"}
"*the human brain has a superior ability to mentally manipulate animate
and inanimate patterns into a myriad of intangible symbols that can then
be recombined to produce new images of the world;* "
:::

. . .

<br>

::: {style="font-size: 1.10em; color: #ffac00;"}
"*we therefore live partly in worlds of our own mental creation,
super-imposed upon or distinct from the natural world.*"
:::

. . .

<br>

::: {style="font-size: 0.90em; color: #05ffa1;"}
\- Source: [Superior pattern processing is the essence of the evolved
human
brain](https://www.frontiersin.org/articles/10.3389/fnins.2014.00265/full)
:::

# Graphs allow us to explore complexity with ***symbols*** and ***images*** {.smaller}

## Exploratory Data Analysis

<br>

"Exploratory Data Analysis (EDA)" first coined by American mathematician
John Tukey in 1977

. . .

::: columns
::: {.column width="50%"}
```{r eda-tukey, echo=FALSE, fig.align='center', out.height='35%', out.width='35%'}
knitr::include_graphics("../img/eda-tukey.jpg")
```
:::

::: {.column width="50%"}
::: {style="font-size: 1.25em; color: #ffac00;"}
"*The greatest value of a picture is when it forces us to notice what we
never expected to see.*"
:::
:::
:::

. . .

::: {style="font-size: 0.95em; color: #05ffa1;"}
\- John Tukey,
[1977](http://www.ru.ac.bd/wp-content/uploads/sites/25/2019/03/102_05_01_Tukey-Exploratory-Data-Analysis-1977.pdf)
:::

# Exploration requires 'listening'

<br><br>

. . .

::: {style="font-size: 1.50em; color: #ffac00;"}
*"The role of the data analyst is to listen to the data in as many ways
as possible until a plausible 'story' of the data is apparent"*
:::

. . .

<br>

::: {style="font-size: 0.95em; color: #05ffa1;"}
\- John T. Behrens, [Principles and Procedures of Exploratory Data
Analysis](https://psycnet.apa.org/record/1997-06270-001)
:::

# Exploration is a 'state of mind'

. . .

<br>

::: {style="font-size: 1.10em; color: #ffac00;"}
*"More than anything, EDA is a state of mind. During the initial phases
of EDA you should feel free to investigate every idea that occurs to
you. Some of these ideas will pan out, and some will be dead ends..."*
:::

. . .

<br>

::: {style="font-size: 1.10em; color: #ffac00;"}
*"As your exploration continues, you will hone in on a few particularly
productive areas that you'll eventually write up and communicate to
others."*
:::

. . .

<br>

::: {style="font-size: 0.95em; color: #05ffa1;"}
\- Hadley Wickham, [R for Data Science](https://r4ds.hadley.nz/eda)
:::

# An Exploratory Mindset

## Exploration requires a Bayesian Mindset (1 of 3)

. . .

<br>

We all have implicit beliefs, or priors, about the world

. . .

<br>

::: columns
::: {.column width="40%"}
::: {style="font-size: 1.05em; color: #3D9CD8;"}
*What we think we know (i.e.,our expectations)*
:::
:::

::: {.column width="60%"}
```{r bayesian-eda-prior-png, echo=FALSE, eval=TRUE, fig.align='center', out.height='65%', out.width='65%'}
knitr::include_graphics("../img/bayesian-eda-priors.png")
```
:::
:::

## Exploration requires a Bayesian Mindset (2 of 3)

. . .

<br>

When we encounter new information or data, our priors get updated

. . .

<br>

::: columns
::: {.column width="40%"}
::: {style="font-size: 1.05em; color: #3D9CD8;"}
*Our expectations + new data (i.e., what we see)*
:::
:::

::: {.column width="60%"}
```{r bayesian-eda-new-png, echo=FALSE, eval=TRUE, fig.align='center', out.height='65%', out.width='65%'}
knitr::include_graphics("../img/bayesian-eda-new.png")
```
:::
:::

## Exploration requires a Bayesian Mindset (3 of 3)

. . .

<br>

Our updated beliefs, or posteriors, depend on our priors ***and*** our
perceptions of the new information

. . .

<br>

::: columns
::: {.column width="40%"}
::: {style="font-size: 1.05em; color: #3D9CD8;"}
*What we expect + what we see = what we've learned*
:::
:::

::: {.column width="60%"}
```{r bayesian-eda-posteriors.png, echo=FALSE, eval=TRUE, fig.align='center', out.height='68%', out.width='68%'}
knitr::include_graphics("../img/bayesian-eda-posteriors.png")
```
:::
:::

## Graphs can confirm our expectations {.smaller}

. . .

<br>

::: question
::: {style="font-size: 1.25em;"}
*What if our expectation was that **X** is related to **Y**?*
:::
:::

. . .

::: columns
::: {.column width="20%"}
::: {style="font-size: 1.25em;"}
<br><br><br> *...then we graphed the data...*
:::
:::

::: {.column width="80%"}
```{r cor90df, fig.align='right', echo=FALSE}
ggplot(data = cor90df, mapping = aes(x = X, y = Y)) + 
  geom_point(size = 3)
```
:::
:::

. . .

::: {style="font-size: 1.40em; color: #3D9CD8;"}
*We would say our expectations have been **confirmed***
:::

## Graphs can refute our expectations {.smaller}

. . .

<br>

::: question
::: {style="font-size: 1.25em;"}
*What if our expectation was that **X** is related to **Y**?*
:::
:::

. . .

::: columns
::: {.column width="20%"}
::: {style="font-size: 1.25em;"}
<br><br><br> *...then we graphed the data...*
:::
:::

::: {.column width="80%"}
```{r cor20df, fig.align='right', echo=FALSE}
ggplot(data = cor20df, mapping = aes(x = X, y = Y)) + 
  geom_point(size = 3)
```
:::
:::

. . .

::: {style="font-size: 1.45em; color: #3D9CD8;"}
*We would say our expectations have been **refuted***
:::

# `ggplot2`: grammar & syntax

## Grammar

. . .

<br>

The system of rules for any given language

. . .

<br>

Includes:

::: incremental
1.  Word meanings
2.  Internal structure
3.  Word arrangement
:::

## Syntax {.smaller}

. . .

<br>

::: {style="font-size: 1.25em;"}
The form, structure and order for constructing statements
:::

. . .

<br>

```{r grammar-exaample.png, echo=FALSE, eval=TRUE, fig.align='center', out.height='45%', out.width='45%'}
knitr::include_graphics("../img/grammar-example.png")
```

. . .

::: columns
::: {.column width="50%"}
::: {style="font-size: 0.80em;"}
`[[students][[cook][and][serve grandparents]]]`
:::
:::

::: {.column width="50%"}
::: {style="font-size: 0.80em;"}
`[[students][[cook and serve][grandparents]]]`
:::
:::
:::

# `ggplot2` : grammar & syntax {.smaller}

. . .

<br>

::: {style="font-size: 1.25em;"}
Built on top of the grammar & syntax of R
:::

. . .

<br>

::: {style="font-size: 1.40em;"}
> "*In R, objects are like nouns, and functions (**fn**) are like
> verbs*"
:::

. . .

<br>

::: columns
::: {.column width="50%"}
```{r fn-object, eval=FALSE, echo=TRUE}
fn(object)
```
:::

::: {.column width="50%"}
:::
:::

. . .

<br>

::: {style="font-size: 1.40em;"}
**functions** do things to *objects*
:::

## `ggplot2`: a layered language for graphs

<br>

. . .

`ggplot2` is comprised of layers  

::: columns
::: {.column width="50%"}
::: {.incremental}
- Data 
- Mapping 
- Statistics 
- Geometric objects  
- Position adjustments  
:::
:::

::: {.column width="50%"}
```{r ggplot2-layers, echo=FALSE, eval=TRUE, fig.align='center', out.height='85%', out.width='85%'}
knitr::include_graphics("../img/ggplot2-layers.png")
```
:::
:::


# `ggplot2`: data {.smaller}

. . .

<br>

::: {style="font-size: 1.40em;"}
The **data layer** consists of a rectangular object (like a spreadsheet) with columns and rows
:::

. . .

<br>

::: columns
::: {.column width="45%"}
```{r data-layer-code, eval=FALSE, echo=TRUE}
ggplot(data = penguins)
```

:::

::: {.column width="2%"}

:::

::: {.column width="53%"}
```{r data-layer, echo=FALSE, eval=TRUE, fig.align='center', out.height='100%', out.width='100%'}
knitr::include_graphics("../img/data-layer.png")
```
:::
:::


# `ggplot2`: mapping {.smaller}

. . .

<br>

::: {style="font-size: 1.40em;"}
The **mapping layer** assigns columns (variables) from the data to a visual property (i.e. graph '**`aes`**'thetic)
:::

. . .

<br>

::: columns
::: {.column width="45%"}
```{r mapping-layer-code, eval=FALSE, echo=TRUE}
ggplot(data = penguins,
  mapping = aes(x = flipper_length_mm, 
                y = bill_length_mm))
```

:::

::: {.column width="2%"}

:::

::: {.column width="53%"}
```{r mapping-layer.png, echo=FALSE, eval=TRUE, fig.align='center', out.height='100%', out.width='100%'}
knitr::include_graphics("../img/mapping-layer.png")
```
:::
:::

# `ggplot2`: geoms {.smaller}

. . .

<br>

::: {style="font-size: 1.40em;"}
`geom_*()` functions include statistical transformations, shapes, and position adjustments for how to 'draw' the data on the graph
:::

. . .

<br>

::: columns
::: {.column width="46%"}
```{r geom-layer-code, eval=FALSE, echo=TRUE}
ggplot(data = penguins,
  mapping = aes(x = flipper_length_mm, 
                y = bill_length_mm)) +
  geom_point()
```

:::

::: {.column width="2%"}

:::

::: {.column width="52%"}
```{r geom-layer.png, echo=FALSE, eval=TRUE, fig.align='center', out.height='100%', out.width='100%'}
knitr::include_graphics("../img/geom-layer.png")
```
:::
:::

# `ggplot2`: layers {.smaller}

. . .

<br>

::: {style="font-size: 1.40em;"}
We can have multiple layers (data, mappings, geoms) in a single graph
:::

. . .

<br>

::: columns
::: {.column width="40%"}
```{r layers-layer-code, eval=FALSE, echo=TRUE}
ggplot(data = penguins,
 # layer 1
  mapping = aes(
    x = flipper_length_mm, 
    y = bill_length_mm)) +
  geom_point()
# layer 2
  geom_smooth(
    mapping = aes(
      x = flipper_length_mm,
      y = bill_length_mm,
      color = species))
```

:::

::: {.column width="2%"}

:::

::: {.column width="58%"}
```{r layers-layer.png, echo=FALSE, eval=TRUE, fig.align='center', out.height='100%', out.width='100%'}
knitr::include_graphics("../img/layers-layer.png")
```
:::
:::

# Layers = infinitely extensible {.smaller}

<br>

. . .

<br>

::: {style="font-size: 1.40em;"}
`ggplot2` is a system for,
:::

. . .

<br>

::: {style="font-size: 1.40em;"}

> “*making infinite use of finite means*” - [Wilhelm von Humboldt](https://en.wikipedia.org/wiki/Wilhelm_von_Humboldt)

:::

. . .

<br>

::: {style="font-size: 1.40em;"}
***With a finite number of objects & functions, we can combine `ggplot2`'s grammar and syntax to create an infinite number of graphs!***
:::

# `ggplot2`: templates {.smaller}

. . .

<br>

::: {style="font-size: 1.25em;"}
**Basic Template**: [Data,]{.fragment .fade-in} [aesthetic mappings,]{.fragment .fade-in} [geom]{.fragment .fade-in}
:::

. . .

<br>

::: columns
::: {.column width="58%"}
```r
ggplot(data = <DATA>) +
  geom_*(mapping = aes(<AESTHETIC MAPPINGS>))
```
:::


::: {.column width="2%"}

:::

::: {.column width="40%"}
```{r ggplot2-layers-dark, echo=FALSE, eval=TRUE, fig.align='right', out.height='100%', out.width='100%'}
knitr::include_graphics("../img/ggplot2-layers-dark.png")
```
:::
:::

# `ggplot2`: more templates {.smaller}

. . .

<br>

::: {style="font-size: 1.25em;"}
**Template + 1 Layer**: [more geoms]{.fragment .fade-in} [and more aesthetic mappings]{.fragment .fade-in}
:::

. . .

<br>

::: columns
::: {.column width="58%"}
```r
ggplot(data = <DATA>) +
    geom_*(mapping = aes(<AESTHETIC MAPPINGS>)) +
    geom_*(mapping = aes(<AESTHETIC MAPPINGS>))
```
:::


::: {.column width="2%"}
:::

::: {.column width="40%"}
```{r ggplot2-2layers-dark, echo=FALSE, eval=TRUE, fig.align='center', out.height='65%', out.width='65%'}
knitr::include_graphics("../img/ggplot2-2layers-dark.png")
```
:::
:::

# `ggplot2`: even more! {.smaller}

. . .

<br>

::: {style="font-size: 1.25em;"}
**Template + 1 Layer + Facet Layer**: [template,]{.fragment .fade-in} [more aesthetic mappings,]{.fragment .fade-in} [and facets!]{.fragment .fade-in}
:::



. . .

<br>

::: columns
::: {.column width="58%"}
```r
ggplot(data = <DATA>) +
    geom_*(mapping = aes(<AESTHETIC MAPPINGS>)) +
    geom_*(mapping = aes(<AESTHETIC MAPPINGS>)) +
    facet_*
```
:::


::: {.column width="2%"}
:::

::: {.column width="40%"}
```{r ggplot2-3layers-dark, echo=FALSE, eval=TRUE, fig.align='center', out.height='60%', out.width='60%'}
knitr::include_graphics("../img/ggplot2-3layers-dark.png")
```
:::
:::

## Templates = infinitely extensible! {.smaller}

<br><br><br>

. . .


**Themes**
```r
ggplot(data = <DATA>) +
    geom_*(mapping = aes(<AESTHETIC MAPPINGS>)) +
    geom_*(mapping = aes(<AESTHETIC MAPPINGS>)) +
    facet_* +
    theme_*
```

. . .

**Don't forget labels!**
```r
ggplot(data = <DATA>) +
    geom_*(mapping = aes(<AESTHETIC MAPPINGS>)) +
    geom_*(mapping = aes(<AESTHETIC MAPPINGS>)) +
    facet_* +
    theme_* +
    labs()
```

# Part 2 {background-color="#1dfd07"}

::: columns
::: {.column width="25%"}
:::

::: {.column width="75%"}
::: incremental
-   RStudio Cloud :heavy_check_mark:
-   Exercises & solutions :heavy_check_mark:
-   Creating a graph (layer-by-layer) :heavy_check_mark:
-   Applying the grammar :heavy_check_mark:
:::
:::
:::

# RStudio.Cloud 

## RStudio.Cloud: Set up (1 of 4)

<br>

::::: {.columns}
:::: {.column width="50%"}
::: {.fragment}
::: {.incremental}
Head to [RStudio.Cloud](https://rstudio.cloud/), you will see the following:
```{r rscloud-landing, echo=FALSE, eval=TRUE, fig.align='center', out.height='50%', out.width='50%'}
knitr::include_graphics("../img/rscloud-landing.png")
```
:::
:::
::::
:::: {.column width="50%"}
::: {.fragment}
<br><br><br>
Log in with your GitHub credentials
:::
::::
:::::

## RStudio.Cloud: Set up (2 of 4)

<br>

::::: {.columns}
:::: {.column width="50%"}
::: {.fragment}
::: {.incremental}
On the top of the RStudio IDE, you will see the following:
```{r rscloud-env, echo=FALSE, eval=TRUE, fig.align='center', out.height='100%', out.width='100%'}
knitr::include_graphics("../img/rscloud-env.png")
```
:::
:::
::::
:::: {.column width="50%"}
::: {.fragment}
<br><br><br><br><br><br>
Click on ***Save a Permanent Copy*** to add this project to your workspace
:::
::::
:::::

## RStudio.Cloud: Set up (3 of 4)

<br>

::::: {.columns}
:::: {.column width="40%"}
::: {.fragment}
::: {.incremental}
In the Files pane, click on the `inst.R` file to open it
:::
:::
::::
:::: {.column width="60%"}
::: {.fragment}
<br><br><br>
```{r rscloud-open-inst, echo=FALSE, eval=TRUE, fig.align='center', out.height='100%', out.width='100%'}
knitr::include_graphics("../img/rscloud-open-inst.png")
```
:::
::::
:::::



## RStudio.Cloud: Set up (4 of 4)

<br>

::::: {.columns}
:::: {.column width="40%"}
::: {.fragment}
::: {.incremental}
In the Source pane, click on the Source icon to run `inst.R`
:::
:::
::::
:::: {.column width="60%"}
::: {.fragment}
<br>
```{r rscloud-source-inst, echo=FALSE, eval=TRUE, fig.align='center', out.height='100%', out.width='100%'}
knitr::include_graphics("../img/rscloud-source-inst.png")
```
This sends the code in `inst.R` to the **Console**
:::
::::
:::::

# RStudio.Cloud: Exercises 

::::: {.columns}
:::: {.column width="25%"}
::: {.fragment}
::: {.incremental}
::: {style="font-size: 0.75em;"}
<br><br><br><br>
The exercises are in the `exercises/` folder
:::
:::
:::
::::
:::: {.column width="75%"}
::: {.fragment}
<br>
```{r rscloud-exercises, echo=FALSE, eval=TRUE, fig.align='center', out.height='100%', out.width='100%'}
knitr::include_graphics("../img/rscloud-exercises.png")
```
:::
::::
:::::

# RStudio.Cloud: Solutions

::::: {.columns}
:::: {.column width="25%"}
::: {.fragment}
::: {.incremental}
::: {style="font-size: 0.75em;"}
<br><br><br><br>
Each exercise has a solution file in `solutions/` folder
:::
:::
:::
::::
:::: {.column width="75%"}
::: {.fragment}
<br>
```{r rscloud-solutions, echo=FALSE, eval=TRUE, fig.align='center', out.height='100%', out.width='100%'}
knitr::include_graphics("../img/rscloud-solutions.png")
```
:::
::::
:::::

# Quick Tip 

. . .

<br>

::: {style="font-size: 1.20em; color: #d107fd;"}
*Tip: writing code can be frustrating, especially in the beginning...*
:::

. . .

<br>

::: {style="font-size: 1.20em; color: #d107fd;"}
*...it doesn't always produce a tangible result...*
:::

. . .

<br>

::: {style="font-size: 1.20em; color: #d107fd;"}
*...but creating visualizations is rewarding!!!*
:::

## `ggplot2`: build the labels first!

. . .

<br>

- Create a `title`, `subtitle` (with data source), and `x`/`y` axis labels

. . .

::: columns
::: {.column width="79%"}
```{r labs_pengiuns, eval=TRUE, echo=TRUE}
labs_pengiuns <- ggplot2::labs(
  title = "Flipper vs. Bill Length",
  subtitle = "source: palmerpenguins::penguins",
  x = "flipper length (mm)",
  y = "bill length (mm)")
```
:::

::: {.column width="2%"}

:::

::: {.column width="19%"}
::: {style="font-size: 0.75em; color: #ff0202;"}
**<- expectations**
:::
:::
:::

## `ggplot2`: build graph, check labels {.smaller}

<br>

. . .

::: {style="font-size: 1.20em;"}
Build labels, [build graphs,]{.fragment .fade-in} [then check labels!]{.fragment .fade-in .highlight-red}
:::

. . .

<br>

::: columns
::: {.column width="41%"}
::: {style="font-size: 0.70em;"}
```{r ggp_peng_point, eval=TRUE, echo=TRUE}
labs_pengiuns <- ggplot2::labs(
  title = "Flipper vs. Bill Length",
  subtitle = "source: palmerpenguins::penguins",
  x = "flipper length (mm)",
  y = "bill length (mm)")
ggp_peng_point <- ggplot(data = penguins,
    mapping = aes(x = bill_length_mm,
                  y = flipper_length_mm)) +
  labs_pengiuns
```
:::
:::

::: {.column width="2%"}

:::

::: {.column width="57%"}
```{r render-ggp_peng_point, eval=TRUE, echo=FALSE}
ggp_peng_point
```
:::
:::

. . .

::: {style="font-size: 01.50em; color: #ff0202;"}
*What's wrong here?*
:::

## `ggplot2`: build graph, check labels, *revise* {.smaller}

<br>

. . .

::: {style="font-size: 1.25em;"}
`x` and `y` are flipped! 
:::

. . .

<br>

::: columns
::: {.column width="41%"}
::: {style="font-size: 0.70em;"}
```{r revise_ggp_peng_point, eval=TRUE, echo=TRUE}
#| code-line-numbers: "7-8"
labs_pengiuns <- ggplot2::labs(
  title = "Flipper vs. Bill Length",
  subtitle = "source: palmerpenguins::penguins",
  x = "flipper length (mm)",
  y = "bill length (mm)")
ggp_peng_point <- ggplot(data = penguins,
    mapping = aes(x = flipper_length_mm, 
                  y = bill_length_mm)) +
                labs_pengiuns 
```
:::
:::

::: {.column width="2%"}

:::

::: {.column width="57%"}
```{r render-revise_ggp_peng_point, eval=TRUE, echo=FALSE}
ggp_peng_point
```
:::
:::

. . .

::: {style="font-size: 01.50em; color: #45ff00;"}
*Fixed!*
:::

## On the importance of revision:

::: {.fragment fragment-index=1}
::: {style="font-size: 1.10em; color: #ffac00;"}
Revision Sharpens Thinking: 
:::
:::

::: {.fragment fragment-index=2}
::: {style="font-size: 1.10em; color: #ffac00;"}
*"More particularly, rewriting is the key to ***improved thinking***. It demands a real open-mindedness and objectivity."* 
:::
:::

::: {.fragment fragment-index=3}
::: {style="font-size: 1.10em; color: #ffac00;"}
*"It demands a willingness to cull verbiage so that ***ideas stand out clearly***. And it demands a willingness to meet logical contradictions head on and trace them to the premises that have created them."*
:::
:::


::: {.fragment fragment-index=4}
::: {style="font-size: 1.10em; color: #ffac00;"}
*"In short, it forces a writer to get up his courage and ***expose his thinking process to his own intelligence.***"*
:::
:::

. . .

<br>

::: {style="font-size: 0.90em; color: #05ffa1;"}
\- Source: [\— Marvin H. Swift, HBR Clear Writing Means Clear Thinking Means…](https://hbr.org/1973/01/clear-writing-means-clear-thinking-means)
:::

# The data

## Viewing data (1 of 2)

. . .

<br> 

`View()` opens the RStudio data viewer

. . .

<br>

```{r rscloud-view-peng, echo=FALSE, eval=TRUE, fig.align='center', out.height='100%', out.width='100%'}
knitr::include_graphics("../img/rscloud-view-peng.png")
```

## Viewing data (2 of 2)

. . .

<br>

`glimpse()` and `str()` are displayed in the console

<br>

::::: {.columns}
:::: {.column width="50%"}
::: {.fragment}
::: {.incremental}
```{r rscloud-glimpse, echo=FALSE, eval=TRUE, fig.align='center', out.height='100%', out.width='100%'}
knitr::include_graphics("../img/rscloud-glimpse.png")
```
:::
:::
::::
:::: {.column width="50%"}
::: {.fragment}
```{r rscloud-str, echo=FALSE, eval=TRUE, fig.align='center', out.height='100%', out.width='100%'}
knitr::include_graphics("../img/rscloud-str.png")
```
:::
::::
:::::



# Build from scratch, layer-by-layer

## `graph 01`: LABELS!

. . .

<br>

We want to build the labels first:

<br>

::::: {.columns}
:::: {.column width="28%"}
::: {.fragment}
::: {.incremental}
::: {style="font-size: 0.70em;"}
- **title** = "Bill and flipper length of Palmer penguins"  
- **subtitle** = "Size measurements for adult foraging penguins"   
- **x** = "Bill length (mm)"  
- **y** = "Flipper length (mm)" 
:::
:::
:::
::::
:::: {.column width="2%"}
::::
:::: {.column width="70%"}
::: {.fragment}
::: {style="font-size: 0.70em; color: #05ffa1;"}
```{r labs_bill_vs_flippper, eval=TRUE, echo=TRUE}
# build labels
labs_bill_vs_flippper <- ggplot2::labs(
  title = "Bill and flipper length of Palmer penguins",
  subtitle = "Size measurements for adult foraging penguins",
  x = "Bill length (mm)",
  y = "Flipper length (mm)")
```
:::
:::
::::
:::::

## `graph 01`: Initialize plot with data

<br>

. . .

The `ggplot2::ggplot()` function initializes the plot:

<br>

::::: {.columns}
:::: {.column width="38%"}
::: {.fragment}
::: {.incremental}
::: {style="font-size: 0.60em;"}
<br>
Place `penguins` in the `data` argument
```{r g1-ex, eval=FALSE, echo=TRUE}
ggplot(data = penguins)
```
:::
:::
:::
::::
:::: {.column width="2%"}
::::
:::: {.column width="60%"}
::: {.fragment}
::: {style="font-size: 0.70em;"}
This gives us a blank canvas!
```{r g1-sol, eval=TRUE, echo=FALSE}
ggplot(data = penguins)
```
:::
:::
::::
:::::

<br>


## `graph 02`: Map variables to positions

<br>

. . .

We have our data and labels--we just need to add our variables!

<br>

::::: {.columns}
:::: {.column width="40%"}
::: {.fragment}
::: {.incremental}
::: {style="font-size: 0.60em;"}
<br>
Map `bill_length_mm` to `x`
```{r g2-ex, eval=FALSE, echo=TRUE}
#| code-line-numbers: "2"
ggplot(data = penguins,
    mapping = aes(x = bill_length_mm, 
  
            ))
```
<br> 
Map `flipper_length_mm` to `y`
```{r g2-ex-2, eval=FALSE, echo=TRUE}
#| code-line-numbers: "2-3"
ggplot(data = penguins,
  mapping = aes(x = bill_length_mm,
                y = flipper_length_mm))
```
:::
:::
:::
::::
:::: {.column width="2%"}
::::
:::: {.column width="58%"}
::: {.fragment}
::: {style="font-size: 0.70em;"}

Now our canvas has `x` and `y` axes

```{r g2-sol, eval=TRUE, echo=FALSE}
ggplot(data = penguins,
  mapping = aes(x = bill_length_mm,
                y = flipper_length_mm))
```
:::
:::
::::
:::::

## `graph 03`: Adding geoms

. . .

<br>

Add the `geom_point()` function with the `+` symbol

<br>

::::: {.columns}
:::: {.column width="40%"}
::: {.fragment}
::: {.incremental}
::: {style="font-size: 0.60em;"}
```{r g3-ex, eval=FALSE, echo=TRUE}
#| code-line-numbers: "4"
ggplot(data = penguins,
  mapping = aes(x = bill_length_mm,
                y = flipper_length_mm)) +
  geom_point()
```

<br>

Don't confuse this with the pipes (`|>` or `%>%`)  
:::
:::
:::
::::
:::: {.column width="2%"}
::::
:::: {.column width="58%"}
::: {.fragment}
::: {style="font-size: 0.70em;"}

The `geom_point()` function tells R we want to see the points (or dots) on our canvas: 

```{r g3-sol, eval=TRUE, echo=FALSE}
ggplot(data = penguins,
  mapping = aes(x = bill_length_mm,
                y = flipper_length_mm)) +
  geom_point()
```
:::
:::
::::
:::::

## `graph 04`: Don't forget the labels!

. . .

<br>

Finally, we want to add the labels we created (`labs_bill_vs_flippper`) 

::::: {.columns}
:::: {.column width="40%"}
::: {.fragment}
::: {.incremental}
::: {style="font-size: 0.60em;"}
<br>
Add labels with `+` 

```{r g4-ex, eval=FALSE, echo=TRUE}
#| code-line-numbers: "5"
ggplot(data = penguins,
  mapping = aes(x = bill_length_mm,
                y = flipper_length_mm)) +
  geom_point() +
  labs_bill_vs_flippper
```
:::
:::
:::
::::
:::: {.column width="2%"}
::::
:::: {.column width="58%"}
::: {.fragment}
::: {style="font-size: 0.70em;"}

And we have our first graph!

```{r g4-sol, eval=TRUE, echo=FALSE}
ggplot(data = penguins,
  mapping = aes(x = bill_length_mm,
                y = flipper_length_mm)) +
  geom_point() +
  labs_bill_vs_flippper
```
:::
:::
::::
:::::

# Global vs. local mapping

## Global mapping 

. . .

<br>

::: {style="font-size: 0.85em;"}
We've just created a graph by setting global aesthetics
:::

::::: {.columns}
:::: {.column width="40%"}
::: {.fragment}
::: {.incremental}
::: {style="font-size: 0.60em;"}

**Global** = aesthetics are mapped when the graph is initialized with `ggplot()`:

```{r global-aes-ex, eval=FALSE, echo=TRUE}
#| code-line-numbers: "2-3"
ggplot(data = penguins,
  mapping = aes(x = bill_length_mm,
                y = flipper_length_mm)) 
```
:::
:::
:::
::::
:::: {.column width="2%"}
::::
:::: {.column width="58%"}
::: {.fragment}
::: {style="font-size: 0.60em;"}

Recall the layers from Part 1:

```{r globals-aes-sol, echo=FALSE, eval=TRUE, fig.align='center', out.height='100%', out.width='100%'}
knitr::include_graphics("../img/global-aes.png")
```

If we map aesthetics in `ggplot()`, all the following `geom_*()` layers will inherit these aesthetics

:::
:::
::::
:::::

## Local mapping 

. . .

<br>

::: {style="font-size: 0.85em;"}
Mapping aesthetics globally and then adding the `geom_*()` function results in the same graph as when we map aesthetics locally (inside the `geom_*()` function)
:::



::::: {.columns}
:::: {.column width="49%"}
::: {.fragment}
::: {.incremental}
::: {style="font-size: 0.60em;"}
```{r local-map-ex, eval=TRUE, echo=TRUE}
#| code-line-numbers: "2-3"
ggplot(data = penguins,
  mapping = aes(x = bill_length_mm,
                y = flipper_length_mm)) +
    geom_point() +
    labs_bill_vs_flippper
```
:::
:::
:::
::::
:::: {.column width="2%"}
::::
:::: {.column width="49%"}
::: {.fragment}
::: {style="font-size: 0.60em;"}
```{r local-map-sol, eval=TRUE, echo=TRUE}
#| code-line-numbers: "3-4"
ggplot(data = penguins) +
  geom_point(mapping = 
      aes(x = bill_length_mm,
          y = flipper_length_mm)) +
  labs_bill_vs_flippper
```
:::
:::
::::
:::::

## The `ggplot2` templates (refresher)

. . .

::: {style="font-size: 0.85em;"}
The template from part 1 uses local mappings (i.e. aesthetic mappings are set inside the `geom_*` function).
:::

. . .

```{r ggp2-temp, eval=FALSE, echo=TRUE}
# Recall our template from Part 1
ggplot(data = <DATA>) +
  geom_*(mapping = aes(<AESTHETIC MAPPINGS>))
```

. . .

::: {style="font-size: 0.85em;"}
Below we've adjusted the template to include global mappings (and the option to include aesthetic mappings locally)
:::

. . .

```{r adj-ggp2-temp, eval=FALSE, echo=TRUE}
# Adjusted template
ggplot(data = <DATA>,
  mapping = aes(<AESTHETIC MAPPINGS>)) + # global mappings
  geom_*(mapping = aes(<AESTHETIC MAPPINGS>)) # local mappings
```

::: {style="font-size: 0.85em;"}
Read more [here.](https://ggplot2-book.org/collective-geoms.html#different-groups-on-different-layers)
:::



## `graph 05`: Convert global to local mappings

<br>

. . .

For `graph-05.R`, convert the global aesthetics to local aesthetics inside the `geom_point()` function

<br>

::::: {.columns}
:::: {.column width="49%"}
::: {.fragment}
::: {.incremental}
::: {style="font-size: 0.60em;"}
Global
```{r g5-ex, eval=FALSE, echo=TRUE}
#| code-line-numbers: "2-3"
ggplot(data = penguins,
  mapping = aes(x = bill_length_mm,
                y = flipper_length_mm)) +
  geom_point() +
  labs_bill_vs_flippper
```
:::
:::
:::
::::
:::: {.column width="2%"}
::::
:::: {.column width="49%"}
::: {.fragment}
::: {style="font-size: 0.60em;"}
Local
```{r g5-sol, eval=FALSE, echo=TRUE}
#| code-line-numbers: "2-4"
ggplot(data = penguins) +
geom_point(mapping = 
    aes(x = bill_length_mm,
        y = flipper_length_mm)) +
      labs_bill_vs_flippper
```
:::
:::
::::
:::::

# Visual encodings

## What are visual encodings? {.smaller}

. . .

<br>

::: {style="font-size: 1.10em;"}
Visual encodings are what we see on the graph
:::

. . .

<br>

::: {style="font-size: 1.10em;"}
Things like position, size, shape, color, etc.
:::

. . .

```{r visual-encodings, echo=FALSE, eval=TRUE, fig.align='center', out.height='100%', out.width='100%'}
knitr::include_graphics("../img/visual-encodings.png")
```

. . .

::: {style="font-size: 1.10em;"}
*Ranked by accuracy*
:::

## `graph 06`: Adding color (global)

. . .

<br>

Map `color` to the `species` variable using **global** aesthetic mapping:

::::: {.columns}
:::: {.column width="40%"}
::: {.fragment}
::: {.incremental}
::: {style="font-size: 0.70em;"}
*Inside* the `aes()` function:
```{r , eval=FALSE, echo=TRUE}
#| code-line-numbers: "5"
ggplot(data = penguins,
  mapping =
    aes(x = bill_length_mm,
        y = flipper_length_mm,
        color = species)) +
  geom_point() +
  labs_bill_vs_flippper
```
:::
:::
:::
::::
:::: {.column width="2%"}
::::
:::: {.column width="50%"}
::: {.fragment}
::: {style="font-size: 0.70em;"}
```{r , eval=TRUE, echo=FALSE}
ggplot(data = penguins,
  mapping =
    aes(x = bill_length_mm,
        y = flipper_length_mm,
        color = species)) +
  geom_point() +
  labs_bill_vs_flippper
```

`ggplot2` includes a legend by default
:::
:::
::::
:::::

## `graph 07`: Adding color (local)

. . .

<br>

Map `color` to the `species` variable using ***local*** aesthetic mapping


::::: {.columns}
:::: {.column width="40%"}
::: {.fragment}
::: {.incremental}
::: {style="font-size: 0.60em;"}
The `x` and `y` aesthetics are inherited from the `ggplot()` function...
```{r , eval=FALSE, echo=TRUE}
#| code-line-numbers: "6"
ggplot(data = penguins,
  mapping =
    aes(x = bill_length_mm,
        y = flipper_length_mm)) +
  geom_point(
    aes(color = species)) +
  labs_bill_vs_flippper
```
:::
:::
:::
::::
:::: {.column width="2%"}
::::
:::: {.column width="58%"}
::: {.fragment}
::: {style="font-size: 0.60em;"}
```{r , eval=TRUE, echo=FALSE}
ggplot(data = penguins,
  mapping =
    aes(x = bill_length_mm,
        y = flipper_length_mm)) +
  geom_point(
    aes(color = species)) +
  labs_bill_vs_flippper
```
...but the `color` aesthetic comes from the `geom_point()` layer
:::
:::
::::
:::::

## `graph 08`: Color vs. Fill (1 of 2)

. . .

::: {style="font-size: 0.85em;"}
Below we'll look at the counts of `sex` vs. `species` of Palmer penguins
:::


::::: {.columns}
:::: {.column width="55%"}
::: {.fragment}
::: {.incremental}
::: {style="font-size: 0.60em;"}
First create labels! 
```{r , eval=TRUE, echo=TRUE}
labs_sex_vs_species <- ggplot2::labs(
  title = "Sex by species of Palmer penguins",
  subtitle = "Counts for adult foraging penguins",
  x = "Sex",
  fill = "Species")
```
<br> 
Create `penguins_no_miss` by removing missing values
```{r , eval=TRUE, echo=TRUE}
penguins_no_miss <- drop_na(data = penguins)
```
:::
:::
:::
::::
:::: {.column width="2%"}
::::
:::: {.column width="43%"}
::: {.fragment}
::: {style="font-size: 0.70em;"}
View our data:
```{r , eval=TRUE, echo=TRUE}
rmarkdown::paged_table(
  head(penguins_no_miss, 5))
```
:::
:::
::::
:::::

## `graph 08`: Color vs. Fill (2 of 2)

. . .

<br>

::: {style="font-size: 0.85em;"}
Some `geom_*()`functions take the `fill` argument instead of `color`
:::

<br>


::::: {.columns}
:::: {.column width="40%"}
::: {.fragment}
::: {.incremental}
::: {style="font-size: 0.60em;"}
Build a bar-graph using `geom_bar()` by locally mapping `sex` to the `x` axis and `y` to `fill`  
```{r , eval=FALSE, echo=TRUE}
#| code-line-numbers: "4"
ggplot(data = penguins_no_miss) +
  geom_bar(
    mapping = aes(x = sex,
                  fill = species)) +
    labs_sex_vs_species
```
<br> 
Don't forget the labels!
:::
:::
:::
::::
:::: {.column width="2%"}
::::
:::: {.column width="58%"}
::: {.fragment}
::: {style="font-size: 0.70em;"}
```{r , eval=TRUE, echo=FALSE}
ggplot(data = penguins_no_miss) +
  geom_bar(
    mapping = aes(x = sex,
                  fill = species)) +
    labs_sex_vs_species
```
:::
:::
::::
:::::

## `graph 09`: Bar position

::::: {.columns}
:::: {.column width="38%"}
::: {.fragment}
::: {.incremental}
::: {style="font-size: 0.60em;"}
<br>
Some text 
```{r , eval=FALSE, echo=TRUE}
# some code 
```
<br> 
More text 
```{r , eval=FALSE, echo=TRUE}
# more code 
```
:::
:::
:::
::::
:::: {.column width="2%"}
::::
:::: {.column width="60%"}
::: {.fragment}
::: {style="font-size: 0.70em;"}
Result 
```{r , eval=TRUE, echo=FALSE}
# solution/result (no code, display only!)
```
:::
:::
::::
:::::

## `graph 10`: Histograms (special bar-graphs)

::::: {.columns}
:::: {.column width="38%"}
::: {.fragment}
::: {.incremental}
::: {style="font-size: 0.60em;"}
<br>
Some text 
```{r , eval=FALSE, echo=TRUE}
# some code 
```
<br> 
More text 
```{r , eval=FALSE, echo=TRUE}
# more code 
```
:::
:::
:::
::::
:::: {.column width="2%"}
::::
:::: {.column width="60%"}
::: {.fragment}
::: {style="font-size: 0.70em;"}
Result 
```{r , eval=TRUE, echo=FALSE}
# solution/result (no code, display only!)
```
:::
:::
::::
:::::

## `graph 11`: Density plots

::::: {.columns}
:::: {.column width="38%"}
::: {.fragment}
::: {.incremental}
::: {style="font-size: 0.60em;"}
<br>
Some text 
```{r , eval=FALSE, echo=TRUE}
# some code 
```
<br> 
More text 
```{r , eval=FALSE, echo=TRUE}
# more code 
```
:::
:::
:::
::::
:::: {.column width="2%"}
::::
:::: {.column width="60%"}
::: {.fragment}
::: {style="font-size: 0.70em;"}
Result 
```{r , eval=TRUE, echo=FALSE}
# solution/result (no code, display only!)
```
:::
:::
::::
:::::

# Mapping vs. setting aesthetics

## Mapping vs. setting (1 of 2)

## Mapping vs. setting (2 of 2)

## `graph 12`: Setting graph aesthetics

::::: {.columns}
:::: {.column width="38%"}
::: {.fragment}
::: {.incremental}
::: {style="font-size: 0.60em;"}
<br>
Some text 
```{r , eval=FALSE, echo=TRUE}
# some code 
```
<br> 
More text 
```{r , eval=FALSE, echo=TRUE}
# more code 
```
:::
:::
:::
::::
:::: {.column width="2%"}
::::
:::: {.column width="60%"}
::: {.fragment}
::: {style="font-size: 0.70em;"}
Result 
```{r , eval=TRUE, echo=FALSE}
# solution/result (no code, display only!)
```
:::
:::
::::
:::::

# Combining layers

## `graph 13`: New layer, new data, no problem

::::: {.columns}
:::: {.column width="38%"}
::: {.fragment}
::: {.incremental}
::: {style="font-size: 0.60em;"}
<br>
Some text 
```{r , eval=FALSE, echo=TRUE}
# some code 
```
<br> 
More text 
```{r , eval=FALSE, echo=TRUE}
# more code 
```
:::
:::
:::
::::
:::: {.column width="2%"}
::::
:::: {.column width="60%"}
::: {.fragment}
::: {style="font-size: 0.70em;"}
Result 
```{r , eval=TRUE, echo=FALSE}
# solution/result (no code, display only!)
```
:::
:::
::::
:::::

## Our label dataset

## `graph 13`: Layer 1

::::: {.columns}
:::: {.column width="38%"}
::: {.fragment}
::: {.incremental}
::: {style="font-size: 0.60em;"}
<br>
Some text 
```{r , eval=FALSE, echo=TRUE}
# some code 
```
<br> 
More text 
```{r , eval=FALSE, echo=TRUE}
# more code 
```
:::
:::
:::
::::
:::: {.column width="2%"}
::::
:::: {.column width="60%"}
::: {.fragment}
::: {style="font-size: 0.70em;"}
Result 
```{r , eval=TRUE, echo=FALSE}
# solution/result (no code, display only!)
```
:::
:::
::::
:::::

## `graph 14`: Layer 2  

::::: {.columns}
:::: {.column width="38%"}
::: {.fragment}
::: {.incremental}
::: {style="font-size: 0.60em;"}
<br>
Some text 
```{r , eval=FALSE, echo=TRUE}
# some code 
```
<br> 
More text 
```{r , eval=FALSE, echo=TRUE}
# more code 
```
:::
:::
:::
::::
:::: {.column width="2%"}
::::
:::: {.column width="60%"}
::: {.fragment}
::: {style="font-size: 0.70em;"}
Result 
```{r , eval=TRUE, echo=FALSE}
# solution/result (no code, display only!)
```
:::
:::
::::
:::::

## `graph 15`: Label 3 (max values)

::::: {.columns}
:::: {.column width="38%"}
::: {.fragment}
::: {.incremental}
::: {style="font-size: 0.60em;"}
<br>
Some text 
```{r , eval=FALSE, echo=TRUE}
# some code 
```
<br> 
More text 
```{r , eval=FALSE, echo=TRUE}
# more code 
```
:::
:::
:::
::::
:::: {.column width="2%"}
::::
:::: {.column width="60%"}
::: {.fragment}
::: {style="font-size: 0.70em;"}
Result 
```{r , eval=TRUE, echo=FALSE}
# solution/result (no code, display only!)
```
:::
:::
::::
:::::

# Facets

## Small multiples 

## Facets = small multiples

## `graph 16`: Facet by sex

::::: {.columns}
:::: {.column width="38%"}
::: {.fragment}
::: {.incremental}
::: {style="font-size: 0.60em;"}
<br>
Some text 
```{r , eval=FALSE, echo=TRUE}
# some code 
```
<br> 
More text 
```{r , eval=FALSE, echo=TRUE}
# more code 
```
:::
:::
:::
::::
:::: {.column width="2%"}
::::
:::: {.column width="60%"}
::: {.fragment}
::: {style="font-size: 0.70em;"}
Result 
```{r , eval=TRUE, echo=FALSE}
# solution/result (no code, display only!)
```
:::
:::
::::
:::::

## `graph 17`: Facet by species

::::: {.columns}
:::: {.column width="38%"}
::: {.fragment}
::: {.incremental}
::: {style="font-size: 0.60em;"}
<br>
Some text 
```{r , eval=FALSE, echo=TRUE}
# some code 
```
<br> 
More text 
```{r , eval=FALSE, echo=TRUE}
# more code 
```
:::
:::
:::
::::
:::: {.column width="2%"}
::::
:::: {.column width="60%"}
::: {.fragment}
::: {style="font-size: 0.70em;"}
Result 
```{r , eval=TRUE, echo=FALSE}
# solution/result (no code, display only!)
```
:::
:::
::::
:::::

# Recap

## What we've covered

# Thanks!




